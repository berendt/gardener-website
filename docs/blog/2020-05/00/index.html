<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Project Gardener Website - A Managed Kubernetes Service Done Right"><meta name=copyright content="Copyright 2019 Gardener project authors."><meta name=google-site-verification content="9EoGiMwk2aq0E_tVh16iJgJbp7fbyqkfWH9b5sGybl0"><title>PingCAP’s Experience in Implementing their Managed TiDB Service with Gardener :: Gardener</title><link rel=icon type=image/x-icon href=https://gardener.cloud/images/favicon.ico><link rel=icon type=image/png href=https://gardener.cloud/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=https://gardener.cloud/images/favicon-16x16.png sizes=16x16><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-W2FGNSX');</script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-165447164-1');</script><link href=/css/nucleus.css?1600269553 rel=stylesheet><link href=/css/font-awesome.min.css?1600269553 rel=stylesheet><link href=/css/hybrid.css?1600269553 rel=stylesheet><link href=/css/featherlight.min.css?1600269553 rel=stylesheet><link href=/css/perfect-scrollbar.min.css?1600269553 rel=stylesheet><link href=/css/auto-complete.css?1600269553 rel=stylesheet><link href=/css/skeleton.css?1600269553 rel=stylesheet><link href=/css/sheetslider.css?1600269553 rel=stylesheet><link rel=stylesheet href=/css/gardener.f83647cf713ea25cfdc21f1ee293222facab94c9f8ffd1ffe01079b633423dca.css><script src=/js/moment.js?1600269553></script><script src=/js/vivus.js?1600269553></script><script src=/js/scrollreveal.js?1600269553></script><script src=/js/inlineSVG.js?1600269553></script><script src=/js/jquery.min.js?1600269553></script><script src=/js/fixed.js?1600269553></script><script src=/js/clipboard.min.js?1600269553></script><script src=https://platform.linkedin.com/in.js type=text/javascript>lang:en_US</script></head><body data-url=/blog/2020-05/00/ class=has-sticky-navigation><script>$(document).ready(function(){function initStickyNav(){var stickyPoint;var tln=document.querySelector(".tln");if(!tln){return;}
var stickyPointEl=document.querySelector(".sticky-nav-point");if(stickyPointEl==null){stickyPointEl=document.querySelector("body");stickyPoint=0;}else{stickyPoint=stickyPointEl.clientHeight+stickyPointEl.offsetTop;}
var bodySelector=document.getElementsByTagName("body")[0];var tlnHeight=tln.clientHeight;var stickyNavigation=function(){if(window.pageYOffset+tlnHeight>=stickyPoint){bodySelector.classList.add("has-sticky-navigation");tln.classList.add("sticky-top");}else{bodySelector.classList.remove("has-sticky-navigation");tln.classList.remove("sticky-top");}}
window.onscroll=function(){stickyNavigation();};}
initStickyNav();});</script><div class="tln fixedsticky sticky-top"><header class=navigation><div class=container><div class=navigation-wrapper><a href=/ class=logo><img src=/images/logo.svg>
<span class=title>Gardener</span></a>
<a class="nav-button navbar-toggler" href=#><i class="fa fa-bars"></i></a><div class=navbar-collapse><ul class=links><li class="link active"><a href=/blog/>Blogs</a></li><li class=link><a href=/community/>Community</a></li><li class=link><a href=/adopter/>Adopters</a></li><li class="link has-child"><a href=/documentation/home>Documentation</a><nav class="container menu"><ul class="topics links"><li data-nav-id=/documentation/home/ title=Home class="dd-item link root" data-depth=0><a href=/documentation/home/><span class=menu-item-text>Home</span></a></li><li data-nav-id=/documentation/concepts/ title=Concepts class="dd-item link root" data-depth=0><a href=/documentation/concepts/><span class=menu-item-text>Concepts</span></a><ul><li data-nav-id=/documentation/concepts/architecture/ title=Architecture class="dd-item link top-level" data-depth=1><a href=/documentation/concepts/architecture/><span class=menu-item-text>Architecture</span></a><ul><li data-nav-id=/components/gardener/ title=Gardener class="dd-item link" data-depth=2><a href=/components/gardener/><span class=menu-item-text>Gardener</span></a></li><li data-nav-id=/components/gardenctl/ title=gardenctl class="dd-item link" data-depth=2><a href=/components/gardenctl/><span class=menu-item-text>gardenctl</span></a></li><li data-nav-id=/components/dashboard/ title=Dashboard class="dd-item link" data-depth=2><a href=/components/dashboard/><span class=menu-item-text>Dashboard</span></a></li><li data-nav-id=/components/kubify/ title=kubify class="dd-item link" data-depth=2><a href=/components/kubify/><span class=menu-item-text>kubify</span></a></li><li data-nav-id=/components/bouquet/ title=Bouquet class="dd-item link" data-depth=2><a href=/components/bouquet/><span class=menu-item-text>Bouquet</span></a></li></ul></li><li data-nav-id=/documentation/concepts/backup-restore/ title="Backup and Restore" class="dd-item link top-level" data-depth=1><a href=/documentation/concepts/backup-restore/><span class=menu-item-text>Backup and Restore</span></a></li><li data-nav-id=/documentation/concepts/core-components/ title="Core Components" class="dd-item link top-level" data-depth=1><a href=/documentation/concepts/core-components/api-server><span class=menu-item-text>Core Components</span></a><ul><li data-nav-id=/documentation/concepts/core-components/api-server/ title="Gardener API Server" class="dd-item link" data-depth=2><a href=/documentation/concepts/core-components/api-server/><span class=menu-item-text>Gardener API Server</span></a><ul><li data-nav-id=/documentation/concepts/core-components/api-server/admission-plugins/ title="In-Tree Admission Plugins" class="dd-item link" data-depth=3><a href=/documentation/concepts/core-components/api-server/admission-plugins/><span class=menu-item-text>In-Tree Admission Plugins</span></a></li></ul></li><li data-nav-id=/documentation/concepts/core-components/gardenlet/ title=Gardenlet class="dd-item link" data-depth=2><a href=/documentation/concepts/core-components/gardenlet/><span class=menu-item-text>Gardenlet</span></a></li><li data-nav-id=/documentation/concepts/core-components/scheduler/ title="Gardener Scheduler" class="dd-item link" data-depth=2><a href=/documentation/concepts/core-components/scheduler/><span class=menu-item-text>Gardener Scheduler</span></a></li><li data-nav-id=/documentation/concepts/core-components/seed-admission-ctrl/ title="Gardener Seed Admission Controller" class="dd-item link" data-depth=2><a href=/documentation/concepts/core-components/seed-admission-ctrl/><span class=menu-item-text>Gardener Seed Admission Controller</span></a></li></ul></li><li data-nav-id=/documentation/concepts/deployment/in_kubernetes/ title="Deploying the Gardener into a Kubernetes cluster" class=dd-item><a href=/documentation/concepts/deployment/in_kubernetes/><span class=toggle></span><span class=menu-item-text></span>Deploying the Gardener into a Kubernetes cluster</span></a></a></li><li data-nav-id=/documentation/concepts/deployment/feature_gates/ title="Feature Gates" class=dd-item><a href=/documentation/concepts/deployment/feature_gates/><span class=toggle></span><span class=menu-item-text></span>Feature Gates</span></a></a></li><li data-nav-id=/documentation/concepts/extensions/ title=Extensions class="dd-item link top-level" data-depth=1><a href=/documentation/concepts/extensions/><span class=menu-item-text>Extensions</span></a><ul><li data-nav-id=/documentation/concepts/extensions/ctrl-registration/ title="Extension controller registration" class="dd-item link" data-depth=2><a href=/documentation/concepts/extensions/ctrl-registration/><span class=menu-item-text>Extension controller registration</span></a></li></ul></li><li data-nav-id=/documentation/concepts/mcm/ title="Machine Controller Manager" class="dd-item link top-level" data-depth=1><a href=/documentation/concepts/mcm/><span class=menu-item-text>Machine Controller Manager</span></a></li><li data-nav-id=/documentation/concepts/monitoring/ title=Monitoring class="dd-item link top-level" data-depth=1><a href=/documentation/concepts/monitoring/><span class=menu-item-text>Monitoring</span></a><ul><li data-nav-id=/documentation/concepts/monitoring/alerting/ title=Alerting class=dd-item><a href=/documentation/concepts/monitoring/alerting/><span class=toggle></span><span class=menu-item-text></span>Alerting</span></a></a></li><li data-nav-id=/documentation/concepts/monitoring/extending/ title="Extending the Monitoring Stack" class=dd-item><a href=/documentation/concepts/monitoring/extending/><span class=toggle></span><span class=menu-item-text></span>Extending the Monitoring Stack</span></a></a></li><li data-nav-id=/documentation/concepts/monitoring/operator_alerts/ title="Operator Alerts" class=dd-item><a href=/documentation/concepts/monitoring/operator_alerts/><span class=toggle></span><span class=menu-item-text></span>Operator Alerts</span></a></a></li><li data-nav-id=/documentation/concepts/monitoring/user_alerts/ title="User Alerts" class=dd-item><a href=/documentation/concepts/monitoring/user_alerts/><span class=toggle></span><span class=menu-item-text></span>User Alerts</span></a></a></li></ul></li><li data-nav-id=/documentation/concepts/networking/ title=Networking class="dd-item link top-level" data-depth=1><a href=/documentation/concepts/networking/><span class=menu-item-text>Networking</span></a><ul><li data-nav-id=/documentation/concepts/networking/cert-management/ title="Certificates Management" class="dd-item link" data-depth=2><a href=/documentation/concepts/networking/cert-management/><span class=menu-item-text>Certificates Management</span></a></li><li data-nav-id=/documentation/concepts/networking/dns_controler_manager/ title="DNS Management" class="dd-item link" data-depth=2><a href=/documentation/concepts/networking/dns_controler_manager/><span class=menu-item-text>DNS Management</span></a></li><li data-nav-id=/documentation/concepts/networking/network-policies/ title="Network Policies" class="dd-item link" data-depth=2><a href=/documentation/concepts/networking/network-policies/><span class=menu-item-text>Network Policies</span></a></li></ul></li></ul></li><li data-nav-id=/documentation/guides/ title="How-To Guides" class="dd-item link root" data-depth=0><a href=/documentation/guides/><span class=menu-item-text>How-To Guides</span></a><ul><li data-nav-id=/documentation/guides/administer_shoots/ title="Administer Client (Shoot) Clusters" class="dd-item link top-level" data-depth=1><a href=/documentation/guides/administer_shoots/><span class=menu-item-text>Administer Client (Shoot) Clusters</span></a></li><li data-nav-id=/documentation/guides/applications/ title=Applications class="dd-item link top-level" data-depth=1><a href=/documentation/guides/applications/><span class=menu-item-text>Applications</span></a></li><li data-nav-id=/documentation/guides/client_tools/ title="Set Up Client Tools" class="dd-item link top-level" data-depth=1><a href=/documentation/guides/client_tools/><span class=menu-item-text>Set Up Client Tools</span></a></li><li data-nav-id=/documentation/guides/gardener-cookies/ title="Gardener Cookies" class="dd-item link top-level" data-depth=1><a href=/documentation/guides/gardener-cookies/><span class=menu-item-text>Gardener Cookies</span></a></li><li data-nav-id=/documentation/guides/install_gardener/ title="Install Gardener" class="dd-item link top-level" data-depth=1><a href=/documentation/guides/install_gardener/><span class=menu-item-text>Install Gardener</span></a></li><li data-nav-id=/documentation/guides/monitoring_and_troubleshooting/ title="Monitor and Troubleshoot" class="dd-item link top-level" data-depth=1><a href=/documentation/guides/monitoring_and_troubleshooting/><span class=menu-item-text>Monitor and Troubleshoot</span></a></li></ul></li><li data-nav-id=/documentation/tutorials/ title=Tutorials class="dd-item link root" data-depth=0><a href=/documentation/tutorials/><span class=menu-item-text>Tutorials</span></a><ul><li data-nav-id=/documentation/tutorials/dynamic-pvc/ title="Dynamic Volume Provisioning" class="dd-item link top-level" data-depth=1><a href=/documentation/tutorials/dynamic-pvc/><span class=menu-item-text>Dynamic Volume Provisioning</span></a></li><li data-nav-id=/documentation/tutorials/featureflag/ title="Feature Flags in Kubernetes Applications" class="dd-item link top-level" data-depth=1><a href=/documentation/tutorials/featureflag/><span class=menu-item-text>Feature Flags in Kubernetes Applications</span></a></li><li data-nav-id=/documentation/tutorials/gpu/ title="GPU Enabled Cluster" class="dd-item link top-level" data-depth=1><a href=/documentation/tutorials/gpu/><span class=menu-item-text>GPU Enabled Cluster</span></a></li><li data-nav-id=/documentation/tutorials/knative-install/ title="Install Knative in Gardener clusters" class="dd-item link top-level" data-depth=1><a href=/documentation/tutorials/knative-install/><span class=menu-item-text>Install Knative in Gardener clusters</span></a></li><li data-nav-id=/documentation/tutorials/node-overprovisioning/ title="Cluster Overprovisioning" class="dd-item link top-level" data-depth=1><a href=/documentation/tutorials/node-overprovisioning/><span class=menu-item-text>Cluster Overprovisioning</span></a></li><li data-nav-id=/documentation/tutorials/s3/ title="Shared storage with S3 backend" class="dd-item link top-level" data-depth=1><a href=/documentation/tutorials/s3/><span class=menu-item-text>Shared storage with S3 backend</span></a></li><li data-nav-id=/documentation/tutorials/shoot_istio_dns_certs/ title="Gardener yourself a Shoot with Istio, custom Domains, and Certificates" class="dd-item link top-level" data-depth=1><a href=/documentation/tutorials/shoot_istio_dns_certs/><span class=menu-item-text>Gardener yourself a Shoot with Istio, custom Domains, and Certificates</span></a></li></ul></li><li data-nav-id=/documentation/references/ title="API Reference" class="dd-item link root" data-depth=0><a href=/documentation/references/><span class=menu-item-text>API Reference</span></a><ul><li data-nav-id=/documentation/references/core/ title=Core class="dd-item link top-level" data-depth=1><a href=/documentation/references/core/><span class=menu-item-text>Core</span></a></li><li data-nav-id=/documentation/references/extensions/ title=Extensions class="dd-item link top-level" data-depth=1><a href=/documentation/references/extensions/><span class=menu-item-text>Extensions</span></a></li><li data-nav-id=/documentation/references/settings/ title=Settings class="dd-item link top-level" data-depth=1><a href=/documentation/references/settings/><span class=menu-item-text>Settings</span></a></li></ul></li><li data-nav-id=/documentation/contribute/ title=Contribute class="dd-item link root" data-depth=0><a href=/documentation/contribute/><span class=menu-item-text>Contribute</span></a><ul><li data-nav-id=/contribute/code/ title=Code class="dd-item link top-level" data-depth=1><a href=/contribute/code/><span class=menu-item-text>Code</span></a><ul><li data-nav-id=/documentation/contribute/10_code/10-contribution_guide/ title="Contribution Guide" class="dd-item link" data-depth=2><a href=/documentation/contribute/10_code/10-contribution_guide/><span class=menu-item-text>Contribution Guide</span></a></li><li data-nav-id=/documentation/contribute/10_code/12-security_guide/ title="Security Release Process" class="dd-item link" data-depth=2><a href=/documentation/contribute/10_code/12-security_guide/><span class=menu-item-text>Security Release Process</span></a></li><li data-nav-id=/documentation/contribute/10_code/13_env/ title=Enviroment class="dd-item link" data-depth=2><a href=/documentation/contribute/10_code/13_env/><span class=menu-item-text>Enviroment</span></a></li><li data-nav-id=/documentation/contribute/10_code/14_cicd/ title=CI/CD class="dd-item link" data-depth=2><a href=/documentation/contribute/10_code/14_cicd/><span class=menu-item-text>CI/CD</span></a></li><li data-nav-id=/documentation/contribute/10_code/15_conf_secrets/ title="Configuration and Usage" class="dd-item link" data-depth=2><a href=/documentation/contribute/10_code/15_conf_secrets/><span class=menu-item-text>Configuration and Usage</span></a></li><li data-nav-id=/documentation/contribute/10_code/20_dependencies/ title=Dependencies class="dd-item link" data-depth=2><a href=/documentation/contribute/10_code/20_dependencies/><span class=menu-item-text>Dependencies</span></a></li><li data-nav-id=/documentation/contribute/10_code/27_deploy_into_cluster/ title="Deploy into a Cluster" class="dd-item link" data-depth=2><a href=/documentation/contribute/10_code/27_deploy_into_cluster/><span class=menu-item-text>Deploy into a Cluster</span></a></li><li data-nav-id=/documentation/contribute/10_code/30_deploy_seed_into_aks/ title="Deploy into AKS" class="dd-item link" data-depth=2><a href=/documentation/contribute/10_code/30_deploy_seed_into_aks/><span class=menu-item-text>Deploy into AKS</span></a></li><li data-nav-id=/documentation/contribute/10_code/37_process/ title=Process class="dd-item link" data-depth=2><a href=/documentation/contribute/10_code/37_process/><span class=menu-item-text>Process</span></a></li><li data-nav-id=/documentation/contribute/10_code/40_repositories/ title=Repositories class="dd-item link" data-depth=2><a href=/documentation/contribute/10_code/40_repositories/><span class=menu-item-text>Repositories</span></a></li></ul></li><li data-nav-id=/contribute/docs/ title=Documentation class="dd-item link top-level" data-depth=1><a href=/contribute/docs/><span class=menu-item-text>Documentation</span></a><ul><li data-nav-id=/documentation/contribute/20_documentation/10_organisation/ title=Organisation class="dd-item link" data-depth=2><a href=/documentation/contribute/20_documentation/10_organisation/><span class=menu-item-text>Organisation</span></a></li><li data-nav-id=/documentation/contribute/20_documentation/20_style/ title="Style Guide" class="dd-item link" data-depth=2><a href=/documentation/contribute/20_documentation/20_style/><span class=menu-item-text>Style Guide</span></a></li><li data-nav-id=/documentation/contribute/20_documentation/25_markup/ title=Markdown class="dd-item link" data-depth=2><a href=/documentation/contribute/20_documentation/25_markup/><span class=menu-item-text>Markdown</span></a><ul><li data-nav-id=/documentation/contribute/20_documentation/25_markup/attachments/ title=Attachments class=dd-item><a href=/documentation/contribute/20_documentation/25_markup/attachments/><span class=toggle></span><span class=menu-item-text></span>Attachments</span></a></a></li><li data-nav-id=/documentation/contribute/20_documentation/25_markup/button/ title=Button class=dd-item><a href=/documentation/contribute/20_documentation/25_markup/button/><span class=toggle></span><span class=menu-item-text></span>Button</span></a></a></li><li data-nav-id=/documentation/contribute/20_documentation/25_markup/expand/ title=Expand class=dd-item><a href=/documentation/contribute/20_documentation/25_markup/expand/><span class=toggle></span><span class=menu-item-text></span>Expand</span></a></a></li><li data-nav-id=/documentation/contribute/20_documentation/25_markup/mermaid/ title=Mermaid class=dd-item><a href=/documentation/contribute/20_documentation/25_markup/mermaid/><span class=toggle></span><span class=menu-item-text></span>Mermaid</span></a></a></li><li data-nav-id=/documentation/contribute/20_documentation/25_markup/notice/ title=Notice class=dd-item><a href=/documentation/contribute/20_documentation/25_markup/notice/><span class=toggle></span><span class=menu-item-text></span>Notice</span></a></a></li></ul></li></ul></li></ul></li></ul></nav></li></ul></div></div></div></header></div><script>$(".navigation .navbar-toggler").click(function(evt){$(".navigation .navbar-collapse").toggle();$(".navigation").toggleClass("collapsed");$(".navigation .search-box").toggle();})</script><div class="main container"><section><div class="highlightable body-inner-wrapper"><div id=body-inner><script src=/js/moment.js></script><div class="blogs page"><a href=/blog class="nav-link back">Back to Blogs</a><article class="post row" data-path><div class=wrapper><div class="two columns"><ul class=authors><li class=author><a href=mailto:wuyelei@pingcap.com><img src="https://avatars0.githubusercontent.com/u/18556593?v=4" class="user-icon icons" alt="blog author avatar">
<span class=name>Aylei Wu</span></a></li><li class=author><a href=mailto:georgi.pavlov@sap.com><img src="https://avatars0.githubusercontent.com/u/52317188?v=4" class="user-icon icons" alt="blog author avatar">
<span class=name>Georgi Pavlov</span></a></li></ul><span class=publishdate data-publishdate=2020-05-27>2020-05-27</span></div><div class="ten columns"><h2>PingCAP’s Experience in Implementing their Managed TiDB Service with Gardener<a href=/blog/2020-05/00/ class="title-link clipboard-copy"><i class="fa fa-link"></i></a></h2><div class=share-ribbon><a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class=twitter-share-button data-text="PingCAP’s Experience in Implementing their Managed TiDB Service with Gardener" data-url=https://gardener.cloud/blog/2020-05/00/ data-hashtags=GardenerProject data-dnt=true data-show-count=false>Tweet</a><script async src=https://platform.twitter.com/widgets.js></script>
<script type=in/share data-url=https://gardener.cloud/blog/2020-05/00/></script></div><p><p>Gardener is showing successful collaboration with its growing community of contributors and adopters. With this come some success stories, including PingCAP using Gardener to implement its managed service.</p><h3 id=about-pingcap-and-its-tidb-cloud>About PingCAP and its TiDB Cloud</h3><p><a href=https://pingcap.com/about/>PingCAP</a> started in 2015, when three seasoned infrastructure engineers working at leading Internet companies got sick and tired of the way databases were managed, scaled and maintained. Seeing no good solution on the market, they decided to build their own - the open-source way. With the help of a first-class team and hundreds of contributors from around the globe, PingCAP is building a distributed NewSQL, hybrid transactional and analytical processing (HTAP) database.</p><p>Its flagship project, <a href=https://en.wikipedia.org/wiki/TiDB>TiDB</a>, is a cloud-native distributed SQL database with MySQL compatibility, and one of the <a href=https://github.com/pingcap/tidb>most popular</a> open-source database projects - with 23.5K+ stars and 400+ contributors. Its sister project <a href=https://github.com/tikv/tikv>TiKV</a> is a <a href="https://landscape.cncf.io/format=card-mode">Cloud Native Interactive Landscape project</a>.</p><p>PingCAP envisioned their managed TiDB service, known as <a href=https://pingcap.com/tidb-cloud/sign-up/>TiDB Cloud</a>, to be multi-tenant, secure, cost-efficient, and to be compatible with different cloud providers. As a result, the company turned to Gardener to build their managed TiDB cloud service offering.</p><img title="TiDB Cloud Beta Preview" src=/blog/2020-05/00/00-001.png style=width:90%;height:auto><figcaption style=text-align:center;margin-top:-25px;margin-bottom:30px;font-size:90%>TiDB Cloud Beta Preview</figcaption><h3 id=limitations-with-other-public-managed-kubernetes-services>Limitations with other public managed Kubernetes services</h3><p>Previously, PingCAP encountered issues while using other public managed K8s cluster services, to develop the first version of its TiDB Cloud. Their worst pain point was that they felt helpless when encountering certain malfunctions. PingCAP wasn’t able to do much to resolve these issues, except waiting for the providers’ help. More specifically, they experienced problems due to cloud-provider specific Kubernetes system upgrades, delays in the support response (which could be avoided in exchange of a costly support fee), and no control over when things got fixed.</p><p>There was also a lot of cloud-specific integration work needed to follow a multi-cloud strategy, which proved to be expensive both to produce and maintain. With one of these managed K8s services, you would have to integrate the instance API, as opposed to a solution like Gardener, which provides a unified API for all clouds. Such a unified API eliminates the need to worry about cloud specific-integration work altogether.</p><img src=/blog/2020-05/00/00-002.png style=width:60%;height:auto><h3 id=why-pingcap-chose-gardener-to-build-tidb-cloud>Why PingCAP chose Gardener to build TiDB Cloud</h3><blockquote><p><i>“Gardener has similar concepts to Kubernetes. Each Kubernetes cluster is just like a Kubernetes pod, so the similar concepts apply, and the controller pattern makes Gardener easy to manage. It was also easy to extend, as the team was already very familiar with Kubernetes, so it wasn’t hard for us to extend Gardener. We also saw that Gardener has a very active community, which is always a plus!”</i><footer>- Aylei Wu, (Cloud Engineer) at PingCAP</footer></p></blockquote><p>At first glance, PingCAP had initial reservations about using Gardener - mainly due to its adoption level (still at the beginning) and an apparent complexity of use. However, these were soon eliminated as they learned more about the solution. As Aylei Wu mentioned during the last <a href="https://www.youtube.com/watch?v=nqkzUylfIbU&feature=youtu.be">Gardener community meeting</a>, <em><strong>“a good product speaks for itself”</strong></em>, and once the company got familiar with Gardener, they quickly noticed that the concepts were very similar to Kubernetes, which they were already familiar with.</p><p>They recognized that Gardener would be their best option, as it is highly extensible and provides a unified abstraction API layer. In essence, the machines can be managed via a machine controller manager for different cloud providers - without having to worry about the individual cloud APIs.</p><p>They agreed that Gardener’s solution, although complex, was definitely worth it. Even though it is a relatively new solution, meaning they didn’t have access to other user testimonials, they decided to go with the service since it checked all the boxes (and as SAP was running it productively with a huge fleet). PingCAP also came to the conclusion that building a managed Kubernetes service themselves would not be easy. Even if they were to build a managed K8s service, they would have to heavily invest in development and would still end up with an even more complex platform than Gardener’s. For all these reasons combined, PingCAP decided to go with Gardener to build its TiDB Cloud.</p><img src=/blog/2020-05/00/00-003.png style=width:70%;height:auto><p>Here are certain features of Gardener that PingCAP found appealing:</p><ul><li><strong>Cloud agnostic:</strong> Gardener’s abstractions for cloud-specific integrations dramatically reduce the investment in supporting more than one cloud infrastructure. Once the integration with Amazon Web Services was done, moving on to Google Cloud Platform proved to be relatively easy. (At the moment, TiDB Cloud has subscription plans available for both GCP and AWS, and they are planning to support Alibaba Cloud in the future.)</li><li><strong>Familiar concepts:</strong> Gardener is K8s native; its concepts are easily related to core Kubernetes concepts. As such, it was easy to onboard for a K8s experienced team like PingCAP’s SRE team.</li><li><strong>Easy to manage and extend:</strong> Gardener’s API and extensibility are easy to implement, which has a positive impact on the implementation, maintenance costs and time-to-market.</li><li><strong>Active community:</strong> Prompt and quality responses on Slack from the Gardener team tremendously helped to quickly onboard and produce an efficient solution.</li></ul><h3 id=how-pingcap-built-tidb-cloud-with-gardener>How PingCAP built TiDB Cloud with Gardener</h3><p>On a technical level, PingCAP’s set-up overview includes the following:</p><ul><li>A Base Cluster globally, which is the top-level control plane of TiDB Cloud</li><li>A Seed Cluster per cloud provider per region, which makes up the fundamental data plane of TiDB Cloud</li><li>A Shoot Cluster is dynamically provisioned per tenant per cloud provider per region when requested</li><li>A tenant may create one or more TiDB clusters in a Shoot Cluster</li></ul><p>As a real world example, PingCAP sets up the Base Cluster and Seed Clusters in advance. When a tenant creates its first TiDB cluster under the us-west-2 region of AWS, a Shoot Cluster will be dynamically provisioned in this region, and will host all the TiDB clusters of this tenant under us-west-2. Nevertheless, if another tenant requests a TiDB cluster in the same region, a <strong>new</strong> Shoot Cluster will be provisioned. Since different Shoot Clusters are located in different VPCs and can even be hosted under different AWS accounts, TiDB Cloud is able to achieve hard isolation between tenants and meet the critical security requirements for our customers.</p><p>To automate these processes, PingCAP creates a service in the Base Cluster, known as the TiDB Cloud “Central” service. The Central is responsible for managing shoots and the TiDB clusters in the Shoot Clusters. As shown in the following diagram, user operations go to the Central, being authenticated, authorized, validated, stored and then applied asynchronously in a controller manner. The Central will talk to the Gardener API Server to create and scale Shoot clusters. The Central will also access the Shoot API Service to deploy and reconcile components in the Shoot cluster, including control components (<a href=https://github.com/pingcap/tidb-operator>TiDB Operator</a>, API Proxy, Usage Reporter for billing, etc.) and the TiDB clusters.</p><img title="TiDB Cloud on Gardener Architecture Overview" src=/blog/2020-05/00/00-004.png style=width:90%;height:auto><figcaption style=text-align:center;margin-top:-25px;margin-bottom:30px;font-size:90%>TiDB Cloud on Gardener Architecture Overview</figcaption><h3 id=whats-next-for-pingcap-and-gardener>What’s next for PingCAP and Gardener</h3><p>With the initial success of using the project to build TiDB Cloud, PingCAP is now working heavily on the stability and day-to-day operations of TiDB Cloud on Gardener. This includes writing Infrastructure-as-Code scripts/controllers with it to achieve GitOps, building tools to help diagnose problems across regions and clusters, as well as running chaos tests to identify and eliminate potential risks. After benefiting greatly from the community, PingCAP will continue to contribute back to Gardener.</p><p>In the future, PingCAP also plans to support more cloud providers like AliCloud and Azure. Moreover, PingCAP may explore the opportunity of running TiDB Cloud in on-premise data centers with the constantly expanding support this project provides. Engineers at PingCAP enjoy the ease of learning from Gardener’s kubernetes-like concepts and being able to apply them everywhere. Gone are the days of heavy integrations with different clouds and worrying about vendor stability. With this project, PingCAP now sees broader opportunities to land TiDB Cloud on various infrastructures to meet the needs of their global user group.</p><p>Stay tuned, more <a href=https://gardener.cloud/blog/>blog posts</a> to come on how Gardener is collaborating with its contributors and adopters to bring fully-managed clusters at scale everywhere! If you want to join in on the fun, <a href=https://gardener.cloud/community/>connect with our community</a>.</p></p></div></div></article><a href=/blog class="nav-link back">Back to Blogs</a></div></div></div></section></div><style></style><footer class=footer><div class="container footer-wrapper"><ul class=nav><li><a href=/blog/>Blogs</a></li><li><a href=/news/>News</a></li><li><a href=/community/>Community</a></li><li><a href=/adopter/>Adopters</a></li><li><a href=/documentation/home>Documentation</a></li></ul><img src=/images/lp/gardener-logo.svg alt="Logo Gardener" class=logo><ul class=media-wr><li><a target=_blank href=https://kubernetes.slack.com/archives/CB57N0BFG><img src=/images/branding/slack-logo-white.svg class=media-icon><div class=media-text>Slack</div></a></li><li><a target=_blank href=https://github.com/gardener><img src=/images/branding/github-mark-logo.png class=media-icon><div class=media-text>GitHub</div></a></li><li><a target=_blank href=https://www.youtube.com/channel/UCwUhwKFREV8Su0gwAJQX7tw><img src=/images/branding/youtube-logo-dark.svg class=media-icon><div class=media-text>YouTube</div></a></li><li><a target=_blank href=https://twitter.com/GardenerProject><img src=/images/branding/twitter-logo-white.svg class=media-icon><div class=media-text>Twitter</div></a></li></ul><span class=copyright>Copyright 2020 Gardener project authors. Privacy Statement</span></div></footer><script src=/js/perfect-scrollbar.min.js?1600269553></script><script src=/js/perfect-scrollbar.jquery.min.js?1600269553></script><script src=/js/jquery.sticky.js?1600269553></script><script src=/js/featherlight.min.js?1600269553></script><script src=/js/html5shiv-printshiv.min.js?1600269553></script><script src=/js/modernizr.custom.71422.js?1600269553></script><link href=/mermaid/mermaid.css?1600269553 type=text/css rel=stylesheet><script src=/mermaid/mermaid.js?1600269553></script><script src=/js/code-snippets.js?1600269553></script><script>mermaid.initialize({startOnLoad:true,htmlLables:true});function createIssue(issueUrl,page,url){var uri=issueUrl+"?title=Documentation issue on page \""+page+"\"";uri=uri+"&body=\n\n<- DESCRIBE MISSING OR FAULTY DOCUMENTATION HERE->\n\n---\nPage: ["+page+"]("+
url+")\ndon't remove the link to the page. It's required for the processor"
var res=encodeURI(uri);res+="&labels=area/documentation"
window.open(res,"issue")
return false;}
$(document).ready(function(){inlineSVG.init();$("[data-publishdate]").each(function(){$(this).text(moment($(this,"YYYY-MM-DD","YYYY-MM-DD hh:mm:ss").attr("data-publishdate")).fromNow());});new ClipboardJS('.clipboard-copy');$("body").codeSnippets();});</script><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-W2FGNSX" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript><script src=/js/modernizr.custom.min.js></script><script src=/js/jsrender.min.js></script><script src=/js/main.js></script><script>$(document).ready(function(){$('.blogs .clipboard-copy').click(function(e){e.preventDefault();});})</script></body></html>