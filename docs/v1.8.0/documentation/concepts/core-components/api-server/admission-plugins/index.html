<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Project Gardener Website - A Managed Kubernetes Service Done Right"><meta name=copyright content="Copyright 2019 Gardener project authors."><meta name=google-site-verification content="9EoGiMwk2aq0E_tVh16iJgJbp7fbyqkfWH9b5sGybl0"><title>Gardener</title><link rel=icon type=image/x-icon href=https://gardener.cloud/images/favicon.ico><link rel=icon type=image/png href=https://gardener.cloud/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=https://gardener.cloud/images/favicon-16x16.png sizes=16x16><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-W2FGNSX');</script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-165447164-1');</script><link href=/css/nucleus.css?1602255805 rel=stylesheet><link href=/css/font-awesome.min.css?1602255805 rel=stylesheet><link href=/css/hybrid.css?1602255805 rel=stylesheet><link href=/css/featherlight.min.css?1602255805 rel=stylesheet><link href=/css/perfect-scrollbar.min.css?1602255805 rel=stylesheet><link href=/css/auto-complete.css?1602255805 rel=stylesheet><link href=/css/skeleton.css?1602255805 rel=stylesheet><link href=/css/sheetslider.css?1602255805 rel=stylesheet><link rel=stylesheet href=/css/gardener.f83647cf713ea25cfdc21f1ee293222facab94c9f8ffd1ffe01079b633423dca.css><script src=/js/moment.js?1602255805></script><script src=/js/vivus.js?1602255805></script><script src=/js/scrollreveal.js?1602255805></script><script src=/js/inlineSVG.js?1602255805></script><script src=/js/jquery.min.js?1602255805></script><script src=/js/fixed.js?1602255805></script><script src=/js/clipboard.min.js?1602255805></script><script src=https://platform.linkedin.com/in.js type=text/javascript>lang:en_US</script></head><body data-url=/v1.8.0/documentation/concepts/core-components/api-server/admission-plugins/ class=has-sticky-navigation><script>$(document).ready(function(){function initStickyNav(){var stickyPoint;var tln=document.querySelector(".tln");if(!tln){return;}
var stickyPointEl=document.querySelector(".sticky-nav-point");if(stickyPointEl==null){stickyPointEl=document.querySelector("body");stickyPoint=0;}else{stickyPoint=stickyPointEl.clientHeight+stickyPointEl.offsetTop;}
var bodySelector=document.getElementsByTagName("body")[0];var tlnHeight=tln.clientHeight;var stickyNavigation=function(){if(window.pageYOffset+tlnHeight>=stickyPoint){bodySelector.classList.add("has-sticky-navigation");tln.classList.add("sticky-top");}else{bodySelector.classList.remove("has-sticky-navigation");tln.classList.remove("sticky-top");}}
window.onscroll=function(){stickyNavigation();};}
initStickyNav();function closeAllSelect(){document.getElementById("docOptions").classList.remove("show");}
function show(e){e.stopPropagation();document.getElementById("docOptions").classList.add("show");}
document.addEventListener("click",closeAllSelect);document.getElementById("docSelector").addEventListener("click",show);});</script><div class="tln fixedsticky sticky-top"><header class=navigation><div class=container><div class=navigation-wrapper><a href=/ class=logo><img src=/images/logo.svg>
<span class=title>Gardener</span></a>
<a class="nav-button navbar-toggler" href=#><i class="fa fa-bars"></i></a><div class=navbar-collapse><ul class=links><li class=link><a href=/blog/>Blogs</a></li><li class=link><a href=/community/>Community</a></li><li class=link><a href=/adopter/>Adopters</a></li><li class="link has-child"><a href=/documentation/>Documentation</a></li></ul></div></div></div></header></div><script>$(".navigation .navbar-toggler").click(function(evt){$(".navigation .navbar-collapse").toggle();$(".navigation").toggleClass("collapsed");$(".navigation .search-box").toggle();})</script><style>#docSelector{cursor:pointer}.doc-options{position:fixed;background-color:#0b8062;text-align:left;display:none}.doc-options ul li{margin-bottom:0}.doc-options ul li a:hover{background-color:#0c694f}.doc-options ul{list-style:none;padding:0;margin:0;text-align:left}.doc-options ul li a{padding:10px;margin:0}.doc-options .activeVersion{background-color:#ec682a}.show{display:block}</style><div class="main container"><section><div class="highlightable body-inner-wrapper"><div id=body-inner><h1 id=admission-plugins>Admission Plugins</h1><p>Similar to the kube-apiserver, the gardener-apiserver comes with a few in-tree managed admission plugins. If you want to get an overview of the what and why of admission plugins then <a href=https://kubernetes.io/docs/reference/access-authn-authz/admission-controllers/>this document</a> might be a good
start.</p><p>This document lists all existing admission plugins with a short explanation of what it is responsible
for.</p><h2 id=clusteropenidconnectpreset-openidconnectpreset><code>ClusterOpenIDConnectPreset</code>, <code>OpenIDConnectPreset</code></h2><p><em>(both enabled by
default)</em></p><p>These admission controllers react on <code>CREATE</code> operations for <code>Shoot</code>s. If the <code>Shoot</code> does not specify any OIDC configuration (<code>.spec.kubernetes.kubeAPIServer.oidcConfig=nil</code>) then it tries to find a matching <code>ClusterOpenIDConnectPreset</code> or <code>OpenIDConnectPreset</code>, respectively. If there are multiples that match then the one with the highest weight &ldquo;wins&rdquo;. In this case, the admission controller will default the OIDC configuration in the
<code>Shoot</code>.</p><h2 id=controllerregistrationresources><code>ControllerRegistrationResources</code></h2><p><em>(enabled by
default)</em></p><p>This admission controller reacts on <code>CREATE</code> and <code>UPDATE</code> operations for <code>ControllerRegistration</code>s. It validates that there exists only one <code>ControllerRegistration</code> in the system that is primarily responsible for a given kind/type resource combination. This prevents misconfiguration by the Gardener
administrator/operator.</p><h2 id=customverbauthorizer><code>CustomVerbAuthorizer</code></h2><p><em>(enabled by
default)</em></p><p>This admission controller reacts on <code>CREATE</code> and <code>UPDATE</code> operations for <code>Project</code>s. It validates whether the user is bound to a RBAC role with the <code>modify-spec-tolerations-whitelist</code> verb in case the user tries to change the
<code>.spec.tolerations.whitelist</code> field of the respective <code>Project</code> resource. Usually, regular project members are not bound to this custom verb, allowing the Gardener administrator to manage certain toleration whitelists on <code>Project</code>
basis.</p><h2 id=deletionconfirmation><code>DeletionConfirmation</code></h2><p><em>(enabled by
default)</em></p><p>This admission controller reacts on <code>DELETE</code> operations for <code>Project</code>s and <code>Shoot</code>s. It validates that the respective resource is annotated with a deletion confirmation annotation, namely <code>confirmation.gardener.cloud/deletion=true</code>. Only if this annotation is present it allows the <code>DELETE</code> operation to pass. This prevents users from accidental/undesired
deletions.</p><h2 id=extensionvalidator><code>ExtensionValidator</code></h2><p><em>(enabled by
default)</em></p><p>This admission controller reacts on <code>CREATE</code> and <code>UPDATE</code> operations for <code>BackupEntry</code>s, <code>BackupBucket</code>s, <code>Seed</code>s, and <code>Shoot</code>s. For all the various extension types in the specifications of these objects, it validates whether there exists a <code>ControllerRegistration</code>
in the system that is primarily responsible for the stated extension type(s). This prevents misconfigurations that would otherwise allow users to create such resources with extension types that don&rsquo;t exist in the cluster, effectively leading to failing reconciliation
loops.</p><h2 id=plantvalidator><code>PlantValidator</code></h2><p><em>(enabled by
default)</em></p><p>This admission controller reacts on <code>CREATE</code> and <code>UPDATE</code> operations for <code>Plant</code>s. It sets the <code>gardener.cloud/created-by</code> annotation for newly created <code>Plant</code> resources. Also, it prevents creating new <code>Plant</code> resources in <code>Project</code>s that are already have a deletion
timestamp.</p><h2 id=resourcereferencemanager><code>ResourceReferenceManager</code></h2><p><em>(enabled by
default)</em></p><p>This admission controller reacts on <code>CREATE</code> and <code>UPDATE</code> operations for <code>CloudProfile</code>s, <code>Project</code>s, <code>SecretBinding</code>s, <code>Seed</code>s, and <code>Shoot</code>s. Generally, it checks whether referred resources stated in the specifications of these objects exist in the system (e.g., if a referenced <code>Secret</code> exists). However, it also has some special behaviours for certain
resources:</p><ul><li><p><code>CloudProfile</code>s: It rejects removing Kubernetes or machine image versions if there is at least one <code>Shoot</code> that refers to
them.</p></li><li><p><code>Project</code>s: It sets the <code>.spec.createdBy</code> field for newly created <code>Project</code> resources, and defaults the <code>.spec.owner</code> field in case it is empty (to the same value of
<code>.spec.createdBy</code>).</p></li><li><p><code>Seed</code>s: It rejects changing the <code>.spec.settings.shootDNS.enabled</code> value if there is at least one <code>Shoot</code> that refers to this
seed.</p></li><li><p><code>Shoot</code>s: It sets the <code>gardener.cloud/created-by=&lt;username></code> annotation for newly created <code>Shoot</code>
resources.</p></li></ul><h2 id=seedvalidator><code>SeedValidator</code></h2><p><em>(enabled by
default)</em></p><p>This admission controller reacts on <code>DELETE</code> operations for <code>Seed</code>s. It checks whether the seed cluster is referenced by a <code>BackupBucket</code>(s) and/or <code>Shoot</code>(s). If any of this is true, the deletion request is
rejected.</p><h2 id=shootdns><code>ShootDNS</code></h2><p><em>(enabled by
default)</em></p><p>This admission controller reacts on <code>CREATE</code> and <code>UPDATE</code> operations for <code>Shoot</code>s. It tries to assign a default domain to the <code>Shoot</code> if it gets scheduled to a seed that enables DNS for shoots (<code>.spec.settings.shootDNS.enabled=true</code>). It also validates that the DNS configuration (<code>.spec.dns</code>) is not set if the seed disables DNS for
shoots.</p><h2 id=shootquotavalidator><code>ShootQuotaValidator</code></h2><p><em>(enabled by
default)</em></p><p>This admission controller reacts on <code>CREATE</code> and <code>UPDATE</code> operations for <code>Shoot</code>s. It validates the resource consumption declared in the specification against applicable <code>Quota</code> resources. Only if the applicable <code>Quota</code> resources admit the configured resources in the <code>Shoot</code> then it allows the request. Applicable <code>Quota</code>s are referred in the <code>SecretBinding</code> that is used by the
<code>Shoot</code>.</p><h2 id=shootstatedeletionvalidator><code>ShootStateDeletionValidator</code></h2><p><em>(enabled by
default)</em></p><p>This admission controller reacts on <code>DELETE</code> operations for <code>ShootState</code>s. It prevents the deletion of the respective <code>ShootState</code> resource in case the corresponding <code>Shoot</code> resource does still exist in the system. This prevents losing the shoot&rsquo;s data required to recover it / migrate its control plane to a new seed
cluster.</p><h2 id=shoottolerationrestriction><code>ShootTolerationRestriction</code></h2><p><em>(enabled by
default)</em></p><p>This admission controller reacts on <code>CREATE</code> and <code>UPDATE</code> operations for <code>Shoot</code>s. It validates the <code>.spec.tolerations</code> used in <code>Shoot</code>s against the whitelist of its <code>Project</code>, or against the whitelist configured in the admission controller&rsquo;s configuration, respectively. Additionally, it defaults the <code>.spec.tolerations</code> in <code>Shoot</code>s with those configured in its <code>Project</code>, and those configured in the admission controller&rsquo;s configuration,
respectively.</p><h2 id=shootvalidator><code>ShootValidator</code></h2><p><em>(enabled by
default)</em></p><p>This admission controller reacts on <code>CREATE</code> and <code>UPDATE</code> operations for <code>Shoot</code>s. It validates certain configurations in the specification against the referred <code>CloudProfile</code> (e.g., machine images, machine types, used Kubernetes version, &mldr;). Generally, it
performs validations that cannot be handled by the static API validation due to their dynamic nature (e.g., when something needs to be checked against referred resources). Additionally, it takes over certain defaulting tasks (e.g., default machine image for worker
pools).</p></div></div></section></div><style></style><footer class=footer><div class="container footer-wrapper"><ul class=nav><li><a href=/blog/>Blogs</a></li><li><a href=/news/>News</a></li><li><a href=/community/>Community</a></li><li><a href=/adopter/>Adopters</a></li><li><a href=/documentation/>Documentation</a></li></ul><img src=/images/lp/gardener-logo.svg alt="Logo Gardener" class=logo><ul class=media-wr><li><a target=_blank href=https://kubernetes.slack.com/archives/CB57N0BFG><img src=/images/branding/slack-logo-white.svg class=media-icon><div class=media-text>Slack</div></a></li><li><a target=_blank href=https://github.com/gardener><img src=/images/branding/github-mark-logo.png class=media-icon><div class=media-text>GitHub</div></a></li><li><a target=_blank href=https://www.youtube.com/channel/UCwUhwKFREV8Su0gwAJQX7tw><img src=/images/branding/youtube-logo-dark.svg class=media-icon><div class=media-text>YouTube</div></a></li><li><a target=_blank href=https://twitter.com/GardenerProject><img src=/images/branding/twitter-logo-white.svg class=media-icon><div class=media-text>Twitter</div></a></li></ul><span class=copyright>Copyright 2020 Gardener project authors. Privacy Statement</span></div></footer><script src=/js/perfect-scrollbar.min.js?1602255805></script><script src=/js/perfect-scrollbar.jquery.min.js?1602255805></script><script src=/js/jquery.sticky.js?1602255805></script><script src=/js/featherlight.min.js?1602255805></script><script src=/js/html5shiv-printshiv.min.js?1602255805></script><script src=/js/modernizr.custom.71422.js?1602255805></script><link href=/mermaid/mermaid.css?1602255805 type=text/css rel=stylesheet><script src=/mermaid/mermaid.js?1602255805></script><script src=/js/code-snippets.js?1602255805></script><script>mermaid.initialize({startOnLoad:true,htmlLables:true});function createIssue(issueUrl,page,url){var uri=issueUrl+"?title=Documentation issue on page \""+page+"\"";uri=uri+"&body=\n\n<- DESCRIBE MISSING OR FAULTY DOCUMENTATION HERE->\n\n---\nPage: ["+page+"]("+
url+")\ndon't remove the link to the page. It's required for the processor"
var res=encodeURI(uri);res+="&labels=area/documentation"
window.open(res,"issue")
return false;}
$(document).ready(function(){inlineSVG.init();$("[data-publishdate]").each(function(){$(this).text(moment($(this,"YYYY-MM-DD","YYYY-MM-DD hh:mm:ss").attr("data-publishdate")).fromNow());});new ClipboardJS('.clipboard-copy');$("body").codeSnippets();});</script><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-W2FGNSX" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript></body></html>