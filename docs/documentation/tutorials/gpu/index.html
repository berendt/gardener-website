<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Project Gardener Website - A Managed Kubernetes Service Done Right"><meta name=copyright content="Copyright 2019 Gardener project authors."><meta name=google-site-verification content="9EoGiMwk2aq0E_tVh16iJgJbp7fbyqkfWH9b5sGybl0"><title>GPU Enabled Cluster :: Gardener</title><link rel=icon type=image/x-icon href=https://gardener.cloud/images/favicon.ico><link rel=icon type=image/png href=https://gardener.cloud/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=https://gardener.cloud/images/favicon-16x16.png sizes=16x16><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-W2FGNSX');</script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-165447164-1');</script><link href=/css/nucleus.css?1601976501 rel=stylesheet><link href=/css/font-awesome.min.css?1601976501 rel=stylesheet><link href=/css/hybrid.css?1601976501 rel=stylesheet><link href=/css/featherlight.min.css?1601976501 rel=stylesheet><link href=/css/perfect-scrollbar.min.css?1601976501 rel=stylesheet><link href=/css/auto-complete.css?1601976501 rel=stylesheet><link href=/css/skeleton.css?1601976501 rel=stylesheet><link href=/css/sheetslider.css?1601976501 rel=stylesheet><link rel=stylesheet href=/css/gardener.f83647cf713ea25cfdc21f1ee293222facab94c9f8ffd1ffe01079b633423dca.css><script src=/js/moment.js?1601976501></script><script src=/js/vivus.js?1601976501></script><script src=/js/scrollreveal.js?1601976501></script><script src=/js/inlineSVG.js?1601976501></script><script src=/js/jquery.min.js?1601976501></script><script src=/js/fixed.js?1601976501></script><script src=/js/clipboard.min.js?1601976501></script><script src=https://platform.linkedin.com/in.js type=text/javascript>lang:en_US</script></head><body data-url=/documentation/tutorials/gpu/ class=has-sticky-navigation><script>$(document).ready(function(){function initStickyNav(){var stickyPoint;var tln=document.querySelector(".tln");if(!tln){return;}
var stickyPointEl=document.querySelector(".sticky-nav-point");if(stickyPointEl==null){stickyPointEl=document.querySelector("body");stickyPoint=0;}else{stickyPoint=stickyPointEl.clientHeight+stickyPointEl.offsetTop;}
var bodySelector=document.getElementsByTagName("body")[0];var tlnHeight=tln.clientHeight;var stickyNavigation=function(){if(window.pageYOffset+tlnHeight>=stickyPoint){bodySelector.classList.add("has-sticky-navigation");tln.classList.add("sticky-top");}else{bodySelector.classList.remove("has-sticky-navigation");tln.classList.remove("sticky-top");}}
window.onscroll=function(){stickyNavigation();};}
initStickyNav();function closeAllSelect(){document.getElementById("docOptions").classList.remove("show");}
function show(e){e.stopPropagation();document.getElementById("docOptions").classList.add("show");}
document.addEventListener("click",closeAllSelect);document.getElementById("docSelector").addEventListener("click",show);});</script><div class="tln fixedsticky sticky-top"><header class=navigation><div class=container><div class=navigation-wrapper><a href=/ class=logo><img src=/images/logo.svg>
<span class=title>Gardener</span></a>
<a class="nav-button navbar-toggler" href=#><i class="fa fa-bars"></i></a><div class=navbar-collapse><ul class=links><li class=link><a href=/blog/>Blogs</a></li><li class=link><a href=/community/>Community</a></li><li class=link><a href=/adopter/>Adopters</a></li><li class="link has-child active"><a href=/documentation/tutorials/gpu/>Documentation</a></li></ul></div></div></div></header></div><script>$(".navigation .navbar-toggler").click(function(evt){$(".navigation .navbar-collapse").toggle();$(".navigation").toggleClass("collapsed");$(".navigation .search-box").toggle();})</script><style>#docSelector{cursor:pointer}.doc-options{position:fixed;background-color:#0b8062;text-align:left;display:none}.doc-options ul li{margin-bottom:0}.doc-options ul li a:hover{background-color:#0c694f}.doc-options ul{list-style:none;padding:0;margin:0;text-align:left}.doc-options ul li a{padding:10px;margin:0}.doc-options .activeVersion{background-color:#ec682a}.show{display:block}</style><div class=sln><div class=overlay-band><ul class="nav-list container"><li title=Home><a class=navbar-link href=/documentation/home/>Home</a></li><li title=Concepts><a class=navbar-link href=/documentation/concepts/>Concepts</a></li><li title="How-To Guides"><a class=navbar-link href=/documentation/guides/>How-To Guides</a></li><li title=Tutorials><a class="navbar-link is-active" href=/documentation/tutorials/>Tutorials</a></li><li title="API Reference"><a class=navbar-link href=/documentation/references/>API Reference</a></li><li title=Contribute><a class=navbar-link href=/documentation/contribute/>Contribute</a></li></ul></div></div><div class="main container"><section><div class="highlightable body-inner-wrapper"><div id=body-inner><style>.docs .title{margin:0 0 4rem}</style><div class="docs page"><div class=git-wr><div class=page-contributors>Contributors to this page<div class=contributors-list></div></div><div class=page-edit><span class=last-update>Last update:</span><div id=top-github-link><a class=github-link title="Edit this page" href=https://github.com/gardener/documentation/edit/master/website/documentation/tutorials/gpu/_index.md target=blank><i class="fa fa-edit"></i><span id=top-github-link-text title="Edit this page"></span></a></div></div></div><h1>GPU Enabled Cluster</h1><div class=properties><div class=expertise-level><span class=label title="Expertse level">Expertise</span><svg class="icon level" aria-hidden="true" focusable="false"><use xlink:href="/images/icons/icons.svg#level-2"/></svg></div></div><h2 id=intro>Intro</h2><p>Be aware, that the following sections might be opinionated. Kubernetes, and the GPU support in particular,
are rapidly evolving, which means that this guide is likely to be outdated sometime soon. For this reason,
<strong>contributions are highly appreciated</strong> to update this guide.</p><h2 id=create-a-cluster>Create a Cluster</h2><p>First thing first, let’s create a k8s cluster with GPU accelerated nodes. In this example we will use AWS
<strong>p2.xlarge</strong> EC2 instance because it&rsquo;s the cheapest available option at the moment. Use such cheap instances
for learning to limit your resource costs. <strong>This costs around 1€/hour per GPU</strong></p><p><img src=howto-gpu.png alt=gpu-selection></p><h2 id=install-nvidia-driver-as-daemonset>Install NVidia Driver as Daemonset</h2><div class=highlight><pre class=chroma><code class=language-yaml data-lang=yaml><span class=k>apiVersion</span><span class=p>:</span><span class=w> </span>apps/v1<span class=w>
</span><span class=w></span><span class=k>kind</span><span class=p>:</span><span class=w> </span>DaemonSet<span class=w>
</span><span class=w></span><span class=k>metadata</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=k>name</span><span class=p>:</span><span class=w> </span>nvidia-driver-installer<span class=w>
</span><span class=w>  </span><span class=k>namespace</span><span class=p>:</span><span class=w> </span>kube-system<span class=w>
</span><span class=w>  </span><span class=k>labels</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=k>k8s-app</span><span class=p>:</span><span class=w> </span>nvidia-driver-installer<span class=w>
</span><span class=w></span><span class=k>spec</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=k>selector</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=k>matchLabels</span><span class=p>:</span><span class=w>
</span><span class=w>      </span><span class=k>name</span><span class=p>:</span><span class=w> </span>nvidia-driver-installer<span class=w>
</span><span class=w>      </span><span class=k>k8s-app</span><span class=p>:</span><span class=w> </span>nvidia-driver-installer<span class=w>
</span><span class=w>  </span><span class=k>template</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=k>metadata</span><span class=p>:</span><span class=w>
</span><span class=w>      </span><span class=k>labels</span><span class=p>:</span><span class=w>
</span><span class=w>        </span><span class=k>name</span><span class=p>:</span><span class=w> </span>nvidia-driver-installer<span class=w>
</span><span class=w>        </span><span class=k>k8s-app</span><span class=p>:</span><span class=w> </span>nvidia-driver-installer<span class=w>
</span><span class=w>    </span><span class=k>spec</span><span class=p>:</span><span class=w>
</span><span class=w>      </span><span class=k>hostPID</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span><span class=w>      </span><span class=k>initContainers</span><span class=p>:</span><span class=w>
</span><span class=w>      </span>- <span class=k>image</span><span class=p>:</span><span class=w> </span>squat/modulus<span class=p>:</span>4a1799e7aa0143bcbb70d354bab3e419b1f54972<span class=w>
</span><span class=w>        </span><span class=k>name</span><span class=p>:</span><span class=w> </span>modulus<span class=w>
</span><span class=w>        </span><span class=k>args</span><span class=p>:</span><span class=w>
</span><span class=w>        </span>- compile<span class=w>
</span><span class=w>        </span>- nvidia<span class=w>
</span><span class=w>        </span>- <span class=s2>&#34;410.104&#34;</span><span class=w>
</span><span class=w>        </span><span class=k>securityContext</span><span class=p>:</span><span class=w>
</span><span class=w>          </span><span class=k>privileged</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span><span class=w>        </span><span class=k>env</span><span class=p>:</span><span class=w>
</span><span class=w>        </span>- <span class=k>name</span><span class=p>:</span><span class=w> </span>MODULUS_CHROOT<span class=w>
</span><span class=w>          </span><span class=k>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;true&#34;</span><span class=w>
</span><span class=w>        </span>- <span class=k>name</span><span class=p>:</span><span class=w> </span>MODULUS_INSTALL<span class=w>
</span><span class=w>          </span><span class=k>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;true&#34;</span><span class=w>
</span><span class=w>        </span>- <span class=k>name</span><span class=p>:</span><span class=w> </span>MODULUS_INSTALL_DIR<span class=w>
</span><span class=w>          </span><span class=k>value</span><span class=p>:</span><span class=w> </span>/opt/drivers<span class=w>
</span><span class=w>        </span>- <span class=k>name</span><span class=p>:</span><span class=w> </span>MODULUS_CACHE_DIR<span class=w>
</span><span class=w>          </span><span class=k>value</span><span class=p>:</span><span class=w> </span>/opt/modulus/cache<span class=w>
</span><span class=w>        </span>- <span class=k>name</span><span class=p>:</span><span class=w> </span>MODULUS_LD_ROOT<span class=w>
</span><span class=w>          </span><span class=k>value</span><span class=p>:</span><span class=w> </span>/root<span class=w>
</span><span class=w>        </span>- <span class=k>name</span><span class=p>:</span><span class=w> </span>IGNORE_MISSING_MODULE_SYMVERS<span class=w>
</span><span class=w>          </span><span class=k>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;1&#34;</span><span class=w>          
</span><span class=w>        </span><span class=k>volumeMounts</span><span class=p>:</span><span class=w>
</span><span class=w>        </span>- <span class=k>name</span><span class=p>:</span><span class=w> </span>etc-coreos<span class=w>
</span><span class=w>          </span><span class=k>mountPath</span><span class=p>:</span><span class=w> </span>/etc/coreos<span class=w>
</span><span class=w>          </span><span class=k>readOnly</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span><span class=w>        </span>- <span class=k>name</span><span class=p>:</span><span class=w> </span>usr-share-coreos<span class=w>
</span><span class=w>          </span><span class=k>mountPath</span><span class=p>:</span><span class=w> </span>/usr/share/coreos<span class=w>
</span><span class=w>          </span><span class=k>readOnly</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span><span class=w>        </span>- <span class=k>name</span><span class=p>:</span><span class=w> </span>ld-root<span class=w>
</span><span class=w>          </span><span class=k>mountPath</span><span class=p>:</span><span class=w> </span>/root<span class=w>
</span><span class=w>        </span>- <span class=k>name</span><span class=p>:</span><span class=w> </span>module-cache<span class=w>
</span><span class=w>          </span><span class=k>mountPath</span><span class=p>:</span><span class=w> </span>/opt/modulus/cache<span class=w>
</span><span class=w>        </span>- <span class=k>name</span><span class=p>:</span><span class=w> </span>module-install-dir-base<span class=w>
</span><span class=w>          </span><span class=k>mountPath</span><span class=p>:</span><span class=w> </span>/opt/drivers<span class=w>
</span><span class=w>        </span>- <span class=k>name</span><span class=p>:</span><span class=w> </span>dev<span class=w>
</span><span class=w>          </span><span class=k>mountPath</span><span class=p>:</span><span class=w> </span>/dev<span class=w>
</span><span class=w>      </span><span class=k>containers</span><span class=p>:</span><span class=w>
</span><span class=w>      </span>- <span class=k>image</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;gcr.io/google-containers/pause:3.1&#34;</span><span class=w>
</span><span class=w>        </span><span class=k>name</span><span class=p>:</span><span class=w> </span>pause<span class=w>
</span><span class=w>      </span><span class=k>tolerations</span><span class=p>:</span><span class=w>
</span><span class=w>      </span>- <span class=k>key</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;nvidia.com/gpu&#34;</span><span class=w>
</span><span class=w>        </span><span class=k>effect</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;NoSchedule&#34;</span><span class=w>
</span><span class=w>        </span><span class=k>operator</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Exists&#34;</span><span class=w>
</span><span class=w>      </span><span class=k>volumes</span><span class=p>:</span><span class=w>
</span><span class=w>      </span>- <span class=k>name</span><span class=p>:</span><span class=w> </span>etc-coreos<span class=w>
</span><span class=w>        </span><span class=k>hostPath</span><span class=p>:</span><span class=w>
</span><span class=w>          </span><span class=k>path</span><span class=p>:</span><span class=w> </span>/etc/coreos<span class=w>
</span><span class=w>      </span>- <span class=k>name</span><span class=p>:</span><span class=w> </span>usr-share-coreos<span class=w>
</span><span class=w>        </span><span class=k>hostPath</span><span class=p>:</span><span class=w>
</span><span class=w>          </span><span class=k>path</span><span class=p>:</span><span class=w> </span>/usr/share/coreos<span class=w>
</span><span class=w>      </span>- <span class=k>name</span><span class=p>:</span><span class=w> </span>ld-root<span class=w>
</span><span class=w>        </span><span class=k>hostPath</span><span class=p>:</span><span class=w>
</span><span class=w>          </span><span class=k>path</span><span class=p>:</span><span class=w> </span>/<span class=w>
</span><span class=w>      </span>- <span class=k>name</span><span class=p>:</span><span class=w> </span>module-cache<span class=w>
</span><span class=w>        </span><span class=k>hostPath</span><span class=p>:</span><span class=w>
</span><span class=w>          </span><span class=k>path</span><span class=p>:</span><span class=w> </span>/opt/modulus/cache<span class=w>
</span><span class=w>      </span>- <span class=k>name</span><span class=p>:</span><span class=w> </span>dev<span class=w>
</span><span class=w>        </span><span class=k>hostPath</span><span class=p>:</span><span class=w>
</span><span class=w>          </span><span class=k>path</span><span class=p>:</span><span class=w> </span>/dev<span class=w>
</span><span class=w>      </span>- <span class=k>name</span><span class=p>:</span><span class=w> </span>module-install-dir-base<span class=w>
</span><span class=w>        </span><span class=k>hostPath</span><span class=p>:</span><span class=w>
</span><span class=w>          </span><span class=k>path</span><span class=p>:</span><span class=w> </span>/opt/drivers<span class=w>
</span></code></pre></div><h2 id=install-device-plugin>Install Device Plugin</h2><div class=highlight><pre class=chroma><code class=language-yaml data-lang=yaml><span class=k>apiVersion</span><span class=p>:</span><span class=w> </span>apps/v1<span class=w>
</span><span class=w></span><span class=k>kind</span><span class=p>:</span><span class=w> </span>DaemonSet<span class=w>
</span><span class=w></span><span class=k>metadata</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=k>name</span><span class=p>:</span><span class=w> </span>nvidia-gpu-device-plugin<span class=w>
</span><span class=w>  </span><span class=k>namespace</span><span class=p>:</span><span class=w> </span>kube-system<span class=w>
</span><span class=w>  </span><span class=k>labels</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=k>k8s-app</span><span class=p>:</span><span class=w> </span>nvidia-gpu-device-plugin<span class=w>
</span><span class=w>    </span><span class=c>#addonmanager.kubernetes.io/mode: Reconcile</span><span class=w>
</span><span class=w></span><span class=k>spec</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=k>selector</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=k>matchLabels</span><span class=p>:</span><span class=w>
</span><span class=w>      </span><span class=k>k8s-app</span><span class=p>:</span><span class=w> </span>nvidia-gpu-device-plugin<span class=w>
</span><span class=w>  </span><span class=k>template</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=k>metadata</span><span class=p>:</span><span class=w>
</span><span class=w>      </span><span class=k>labels</span><span class=p>:</span><span class=w>
</span><span class=w>        </span><span class=k>k8s-app</span><span class=p>:</span><span class=w> </span>nvidia-gpu-device-plugin<span class=w>
</span><span class=w>      </span><span class=k>annotations</span><span class=p>:</span><span class=w>
</span><span class=w>        </span><span class=k>scheduler.alpha.kubernetes.io/critical-pod</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;&#39;</span><span class=w>
</span><span class=w>    </span><span class=k>spec</span><span class=p>:</span><span class=w>
</span><span class=w>      </span><span class=k>priorityClassName</span><span class=p>:</span><span class=w> </span>system-node-critical<span class=w>
</span><span class=w>      </span><span class=k>volumes</span><span class=p>:</span><span class=w>
</span><span class=w>      </span>- <span class=k>name</span><span class=p>:</span><span class=w> </span>device-plugin<span class=w>
</span><span class=w>        </span><span class=k>hostPath</span><span class=p>:</span><span class=w>
</span><span class=w>          </span><span class=k>path</span><span class=p>:</span><span class=w> </span>/var/lib/kubelet/device-plugins<span class=w>
</span><span class=w>      </span>- <span class=k>name</span><span class=p>:</span><span class=w> </span>dev<span class=w>
</span><span class=w>        </span><span class=k>hostPath</span><span class=p>:</span><span class=w>
</span><span class=w>          </span><span class=k>path</span><span class=p>:</span><span class=w> </span>/dev<span class=w>
</span><span class=w>      </span><span class=k>containers</span><span class=p>:</span><span class=w>
</span><span class=w>      </span>- <span class=k>image</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;k8s.gcr.io/nvidia-gpu-device-plugin@sha256:08509a36233c5096bb273a492251a9a5ca28558ab36d74007ca2a9d3f0b61e1d&#34;</span><span class=w>
</span><span class=w>        </span><span class=k>command</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&#34;/usr/bin/nvidia-gpu-device-plugin&#34;</span><span class=p>,</span><span class=w> </span><span class=s2>&#34;-logtostderr&#34;</span><span class=p>,</span><span class=w> </span><span class=s2>&#34;-host-path=/opt/drivers/nvidia&#34;</span><span class=p>]</span><span class=w>
</span><span class=w>        </span><span class=k>name</span><span class=p>:</span><span class=w> </span>nvidia-gpu-device-plugin<span class=w>
</span><span class=w>        </span><span class=k>resources</span><span class=p>:</span><span class=w>
</span><span class=w>          </span><span class=k>requests</span><span class=p>:</span><span class=w>
</span><span class=w>            </span><span class=k>cpu</span><span class=p>:</span><span class=w> </span>50m<span class=w>
</span><span class=w>            </span><span class=k>memory</span><span class=p>:</span><span class=w> </span>10Mi<span class=w>
</span><span class=w>          </span><span class=k>limits</span><span class=p>:</span><span class=w>
</span><span class=w>            </span><span class=k>cpu</span><span class=p>:</span><span class=w> </span>50m<span class=w>
</span><span class=w>            </span><span class=k>memory</span><span class=p>:</span><span class=w> </span>10Mi<span class=w>
</span><span class=w>        </span><span class=k>securityContext</span><span class=p>:</span><span class=w>
</span><span class=w>          </span><span class=k>privileged</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span><span class=w>        </span><span class=k>volumeMounts</span><span class=p>:</span><span class=w>
</span><span class=w>        </span>- <span class=k>name</span><span class=p>:</span><span class=w> </span>device-plugin<span class=w>
</span><span class=w>          </span><span class=k>mountPath</span><span class=p>:</span><span class=w> </span>/device-plugin<span class=w>
</span><span class=w>        </span>- <span class=k>name</span><span class=p>:</span><span class=w> </span>dev<span class=w>
</span><span class=w>          </span><span class=k>mountPath</span><span class=p>:</span><span class=w> </span>/dev<span class=w>
</span><span class=w>  </span><span class=k>updateStrategy</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=k>type</span><span class=p>:</span><span class=w> </span>RollingUpdate<span class=w>
</span></code></pre></div><h2 id=test>Test</h2><p>To run an example training on a GPU node, start first a base image with Tensorflow with GPU support & Keras</p><div class=highlight><pre class=chroma><code class=language-yaml data-lang=yaml><span class=k>apiVersion</span><span class=p>:</span><span class=w> </span>apps/v1<span class=w>
</span><span class=w></span><span class=k>kind</span><span class=p>:</span><span class=w> </span>Deployment<span class=w>
</span><span class=w></span><span class=k>metadata</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=k>name</span><span class=p>:</span><span class=w> </span>deeplearning-workbench<span class=w>
</span><span class=w>  </span><span class=k>namespace</span><span class=p>:</span><span class=w> </span>default<span class=w>
</span><span class=w></span><span class=k>spec</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=k>replicas</span><span class=p>:</span><span class=w> </span><span class=m>1</span><span class=w>
</span><span class=w>  </span><span class=k>selector</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=k>matchLabels</span><span class=p>:</span><span class=w>
</span><span class=w>      </span><span class=k>app</span><span class=p>:</span><span class=w> </span>deeplearning-workbench<span class=w>
</span><span class=w>  </span><span class=k>template</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=k>metadata</span><span class=p>:</span><span class=w>
</span><span class=w>      </span><span class=k>labels</span><span class=p>:</span><span class=w>
</span><span class=w>        </span><span class=k>app</span><span class=p>:</span><span class=w> </span>deeplearning-workbench<span class=w>
</span><span class=w>    </span><span class=k>spec</span><span class=p>:</span><span class=w>
</span><span class=w>      </span><span class=k>containers</span><span class=p>:</span><span class=w>
</span><span class=w>      </span>- <span class=k>name</span><span class=p>:</span><span class=w> </span>deeplearning-workbench<span class=w>
</span><span class=w>        </span><span class=k>image</span><span class=p>:</span><span class=w> </span>afritzler/deeplearning-workbench<span class=w>
</span><span class=w>        </span><span class=k>resources</span><span class=p>:</span><span class=w>
</span><span class=w>          </span><span class=k>limits</span><span class=p>:</span><span class=w>
</span><span class=w>            </span><span class=k>nvidia.com/gpu</span><span class=p>:</span><span class=w> </span><span class=m>1</span><span class=w>
</span><span class=w>      </span><span class=k>tolerations</span><span class=p>:</span><span class=w>
</span><span class=w>      </span>- <span class=k>key</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;nvidia.com/gpu&#34;</span><span class=w>
</span><span class=w>        </span><span class=k>effect</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;NoSchedule&#34;</span><span class=w>
</span><span class=w>        </span><span class=k>operator</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Exists&#34;</span><span class=w>
</span></code></pre></div><p>Note: the <code>tolerations</code> section above is not required if you deploy the <code>ExtendedResourceToleration</code>
admission controller to your cluster. You can do this in the <code>kubernetes</code> section of your Gardener
cluster <code>shoot.yaml</code> as follows:</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>  kubernetes:
    kubeAPIServer:
      admissionPlugins:
      - name: ExtendedResourceToleration
</code></pre></div><p>Now exec into the container and start an example Keras training</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>kubectl <span class=nb>exec</span> -it deeplearning-workbench-8676458f5d-p4d2v -- /bin/bash
<span class=nb>cd</span> /keras/example
python imdb_cnn.py
</code></pre></div><h2 id=acknowledgments--references>Acknowledgments & References</h2><ul><li><a href=https://github.com/afritzler/kubernetes-gpu>Andreas Fritzler</a> from the Gardener Core team for the R&D and providing this setup.</li><li><a href=https://github.com/squat/modulus>Build and install NVIDIA driver on CoreOS</a></li><li><a href=https://github.com/kubernetes/kubernetes/blob/master/cluster/addons/device-plugins/nvidia-gpu/daemonset.yaml>Nvidia Device Plugin</a></li></ul></div></div></div><div class=howto_tickets><a href=https://github.com/gardener/documentation/issues/new/choose target=_blank><span>Let us know how can we improve.</span>
<span>Open <img src=https://gardener.cloud/images/branding/github-mark-logo-green.svg> GitHub Issue <i class="fa fa-external-link" aria-hidden=true></i></span></a></div></section></div><style></style><footer class=footer><div class="container footer-wrapper"><ul class=nav><li><a href=/blog/>Blogs</a></li><li><a href=/news/>News</a></li><li><a href=/community/>Community</a></li><li><a href=/adopter/>Adopters</a></li><li><a href=/documentation/home>Documentation</a></li></ul><img src=/images/lp/gardener-logo.svg alt="Logo Gardener" class=logo><ul class=media-wr><li><a target=_blank href=https://kubernetes.slack.com/archives/CB57N0BFG><img src=/images/branding/slack-logo-white.svg class=media-icon><div class=media-text>Slack</div></a></li><li><a target=_blank href=https://github.com/gardener><img src=/images/branding/github-mark-logo.png class=media-icon><div class=media-text>GitHub</div></a></li><li><a target=_blank href=https://www.youtube.com/channel/UCwUhwKFREV8Su0gwAJQX7tw><img src=/images/branding/youtube-logo-dark.svg class=media-icon><div class=media-text>YouTube</div></a></li><li><a target=_blank href=https://twitter.com/GardenerProject><img src=/images/branding/twitter-logo-white.svg class=media-icon><div class=media-text>Twitter</div></a></li></ul><span class=copyright>Copyright 2020 Gardener project authors. Privacy Statement</span></div></footer><script src=/js/perfect-scrollbar.min.js?1601976501></script><script src=/js/perfect-scrollbar.jquery.min.js?1601976501></script><script src=/js/jquery.sticky.js?1601976501></script><script src=/js/featherlight.min.js?1601976501></script><script src=/js/html5shiv-printshiv.min.js?1601976501></script><script src=/js/modernizr.custom.71422.js?1601976501></script><link href=/mermaid/mermaid.css?1601976501 type=text/css rel=stylesheet><script src=/mermaid/mermaid.js?1601976501></script><script src=/js/code-snippets.js?1601976501></script><script>mermaid.initialize({startOnLoad:true,htmlLables:true});function createIssue(issueUrl,page,url){var uri=issueUrl+"?title=Documentation issue on page \""+page+"\"";uri=uri+"&body=\n\n<- DESCRIBE MISSING OR FAULTY DOCUMENTATION HERE->\n\n---\nPage: ["+page+"]("+
url+")\ndon't remove the link to the page. It's required for the processor"
var res=encodeURI(uri);res+="&labels=area/documentation"
window.open(res,"issue")
return false;}
$(document).ready(function(){inlineSVG.init();$("[data-publishdate]").each(function(){$(this).text(moment($(this,"YYYY-MM-DD","YYYY-MM-DD hh:mm:ss").attr("data-publishdate")).fromNow());});new ClipboardJS('.clipboard-copy');$("body").codeSnippets();});</script><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-W2FGNSX" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript></body></html>